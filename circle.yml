---

machine:
  java:
    version: oraclejdk8
  environment:
    TERM: dumb

checkout:
  post:
    - "if [ -e .git/shallow ]; then git fetch --unshallow; fi"
    - git fetch --tags
    - git submodule update --init --remote

test:
  override:
    - >
      if [ -n "${BUILD_JAVADOC}" ]; then
        ./gradlew --stacktrace packageJavadoc;
      else
        ./gradlew --stacktrace --parallel jar test client:fatjar;
      fi

general:
  artifacts:
    - plugins/dist-versioned
    - client/build/libs
    - build/libs/dmdirc-javadoc.jar

